{"version":3,"file":"CommentSection.stories-4b41c2ce.js","sources":["../../src/assets/challenges/comment-section/assets/icon-minus.svg","../../src/assets/challenges/comment-section/assets/icon-plus.svg","../../src/assets/challenges/comment-section/assets/icon-reply.svg","../../src/components/CommentSection/CommentCard.tsx","../../src/components/CommentSection/index.tsx"],"sourcesContent":["export default \"__VITE_ASSET__aefdc3c1__\"","export default \"__VITE_ASSET__ee760976__\"","export default \"__VITE_ASSET__bee77066__\"","import { useLayoutEffect, useRef, useState } from \"react\";\n\nimport { ReactComponent as MinusIcon } from \"../../assets/challenges/comment-section/assets/icon-minus.svg\";\nimport { ReactComponent as PlusIcon } from \"../../assets/challenges/comment-section/assets/icon-plus.svg\";\nimport { ReactComponent as ReplyIcon } from \"../../assets/challenges/comment-section/assets/icon-reply.svg\";\n\nfunction ReplyButton({\n  className = \"\",\n  onClick,\n}: {\n  className?: string;\n  onClick?: () => void;\n}) {\n  return (\n    <button\n      onClick={onClick}\n      className={`flex select-none items-center space-x-1 rounded p-2 focus:bg-[hsl(239,57%,95%)] focus:outline-none focus:ring-1 focus:ring-[hsla(238,40%,52%,0.2)] ${className}`}\n    >\n      <ReplyIcon className=\"w-3 text-[hsl(238,40%,52%)]\" />\n      <span className=\"text-sm font-semibold text-[hsl(238,40%,52%)]\">\n        Reply\n      </span>\n    </button>\n  );\n}\n\nfunction ScoreInput({ score }: { score: number }) {\n  return (\n    <div className=\"flex select-none items-center space-x-2 space-y-0 rounded-md bg-[hsl(223,19%,93%)] p-2 md:flex-col md:space-x-0 md:space-y-1\">\n      <button className=\"p-1 text-[hsl(239,57%,85%)] focus:text-[hsl(238,40%,52%)] focus:outline-none\">\n        <PlusIcon className=\"h-3 w-3\" />\n      </button>\n      <span className=\"px-1 text-[hsl(238,40%,52%)]\">{score}</span>\n      <button className=\"p-1 text-[hsl(239,57%,85%)] focus:text-[hsl(238,40%,52%)] focus:outline-none\">\n        <MinusIcon className=\"h-3 w-3 \" />\n      </button>\n    </div>\n  );\n}\n\nexport default function CommentCard({\n  user,\n  score,\n  content,\n  createdAt,\n  currentUser,\n  currentUserImg,\n  replyingTo,\n  isOwner = false,\n}: {\n  id: string;\n  user: {\n    image: string;\n    username: string;\n  };\n  score: number;\n  content: string;\n  createdAt: string;\n  isOwner?: boolean;\n  currentUser: string;\n  currentUserImg: string;\n  replyingTo?: string;\n  onReplyClicked?: (commentId: string) => void;\n  onScoreChange?: (\n    commentId: string,\n    scoreChangeType: \"increment\" | \"decrement\"\n  ) => void;\n}) {\n  const commentContainerRef = useRef<HTMLDivElement>(null);\n  const [replyContent, setReplyContent] = useState(\"\");\n  const [replyTextareaIsShown, setReplyTextareaShown] = useState(false);\n  const showReplyTextarea = () => {\n    setReplyTextareaShown(!replyTextareaIsShown);\n  };\n\n  useLayoutEffect(() => {\n    const el = commentContainerRef.current?.querySelector<HTMLTextAreaElement>(\n      'textarea[name=\"reply-textarea\"]'\n    );\n\n    if (!el) return;\n\n    el.focus();\n    el.setSelectionRange(-1, -1);\n  }, [replyTextareaIsShown]);\n\n  return (\n    <div ref={commentContainerRef} className=\"space-y-3\">\n      <div className=\"flex flex-col-reverse items-start rounded-lg bg-white p-5 md:flex-row md:space-x-5\">\n        <div className=\"mt-3 flex w-full justify-between md:mt-0 md:w-auto\">\n          <ScoreInput score={score} />\n          {!isOwner && (\n            <ReplyButton className=\"md:hidden\" onClick={showReplyTextarea} />\n          )}\n        </div>\n        <div className=\"flex flex-col space-y-3\">\n          <div className=\"flex content-between\">\n            <div className=\"flex grow select-none items-center space-x-4\">\n              <img\n                className=\"w-6\"\n                src={user.image}\n                alt={`${user.username}'s profile`}\n              />\n              <span className=\"select-all text-sm font-bold text-gray-700\">\n                {user.username}\n                {isOwner && (\n                  <span className=\"ml-2 rounded bg-[hsl(238,40%,52%)] px-1 py-[0.1rem] text-xs text-white\">\n                    you\n                  </span>\n                )}\n              </span>\n\n              <span className=\"text-sm text-[hsl(211,10%,45%)]\">\n                {createdAt}\n              </span>\n            </div>\n            {!isOwner && (\n              <ReplyButton\n                className=\"hidden md:flex\"\n                onClick={showReplyTextarea}\n              />\n            )}\n          </div>\n          <p className=\"text-sm text-[hsl(211,10%,45%)]\">\n            <span className=\"mr-1 font-semibold text-[hsl(238,40%,52%)]\">\n              @{replyingTo}\n            </span>\n            {content}\n          </p>\n        </div>\n      </div>\n      {replyTextareaIsShown && (\n        <div className=\"flex flex-row items-start space-x-3 rounded-lg bg-white p-4\">\n          <img\n            className=\"w-6\"\n            src={currentUserImg}\n            alt={`${currentUser}'s profile`}\n          />\n          <div className=\"flex grow flex-col items-start gap-3 md:flex-row\">\n            <textarea\n              placeholder=\"Add a comment\"\n              className=\"w-full grow rounded-lg border border-[hsl(211,10%,45%)] border-opacity-20 px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-[hsla(238,40%,52%,0.5)]\"\n              rows={3}\n              value={`@${user.username} ` + replyContent}\n              onChange={(e) =>\n                setReplyContent(\n                  e.target.value.substring(`@${user.username} `.length)\n                )\n              }\n              name=\"reply-textarea\"\n            ></textarea>\n            <button className=\" select-none rounded bg-[hsl(238,40%,52%)] px-3 py-2 text-sm uppercase text-white focus:outline-none focus:ring-1 focus:ring-[hsla(238,40%,52%,0.5)]\">\n              Submit\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState } from \"react\";\n\nimport CommentCard from \"./CommentCard\";\nimport classes from \"./CommentSection.module.css\";\n\nexport interface CommentSectionProps {\n  currentUserImg: string;\n  currentUser: string;\n  comments: {\n    id: string;\n    user: {\n      image: string;\n      username: string;\n    };\n    score: number;\n    content: string;\n    createdAt: string;\n    replies: {\n      id: string;\n      user: {\n        image: string;\n        username: string;\n      };\n      score: number;\n      content: string;\n      createdAt: string;\n      replyingTo: string;\n    }[];\n  }[];\n}\n\nexport default function CommentSection({\n  currentUser,\n  currentUserImg,\n  comments,\n}: CommentSectionProps) {\n  const [commentContent, setCommentContent] = useState(\"\");\n\n  return (\n    <section className={`max-w-[40rem] space-y-3 ${classes[\"font-rubik\"]}`}>\n      <div className=\"flex flex-col space-y-3\">\n        {comments.map((comment) => (\n          <div key={comment.id} className=\"space-y-3\">\n            <CommentCard\n              id={comment.id}\n              user={{\n                image: import.meta.env.BASE_URL + comment.user.image,\n                username: comment.user.username,\n              }}\n              score={comment.score}\n              createdAt={comment.createdAt}\n              content={comment.content}\n              isOwner={comment.user.username === currentUser}\n              currentUser={currentUser}\n              currentUserImg={currentUserImg}\n            />\n            {comment.replies.length > 0 && (\n              <div className=\"flex\">\n                <div className=\"mx-3 my-1 border border-[hsl(211,10%,45%)] border-opacity-20 md:mx-8\"></div>\n                <div className=\"flex flex-col space-y-3\">\n                  {comment.replies.map((reply) => (\n                    <CommentCard\n                      key={reply.id}\n                      id={reply.id}\n                      user={{\n                        image: import.meta.env.BASE_URL + reply.user.image,\n                        username: reply.user.username,\n                      }}\n                      score={reply.score}\n                      createdAt={reply.createdAt}\n                      content={reply.content}\n                      isOwner={reply.user.username === currentUser}\n                      replyingTo={reply.replyingTo}\n                      currentUser={currentUser}\n                      currentUserImg={currentUserImg}\n                    />\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n      <div className=\"flex flex-row items-start space-x-3 rounded-lg bg-white p-4\">\n        <img\n          className=\"w-6\"\n          src={currentUserImg}\n          alt={`${currentUser}'s profile`}\n        />\n        <div className=\"flex grow flex-col items-start gap-3 md:flex-row\">\n          <textarea\n            placeholder=\"Add a comment\"\n            className=\"w-full grow rounded-lg border border-[hsl(211,10%,45%)] border-opacity-20 px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-[hsla(238,40%,52%,0.5)]\"\n            rows={3}\n            value={commentContent}\n            onChange={(e) => setCommentContent(e.target.value)}\n          ></textarea>\n          <button className=\" select-none rounded bg-[hsla(238,40%,52%)] px-3 py-2 text-sm uppercase text-white focus:outline-none focus:ring-1 focus:ring-[hsla(238,40%,52%,0.5)]\">\n            Submit\n          </button>\n        </div>\n      </div>\n    </section>\n  );\n}\n"],"names":["SvgIconMinus","props","React.createElement","SvgIconPlus","SvgIconReply","ReplyButton","className","onClick","jsxs","jsx","ReplyIcon","ScoreInput","score","PlusIcon","MinusIcon","CommentCard","user","content","createdAt","currentUser","currentUserImg","replyingTo","isOwner","commentContainerRef","useRef","replyContent","setReplyContent","useState","replyTextareaIsShown","setReplyTextareaShown","showReplyTextarea","useLayoutEffect","el","_a","e","CommentSection","comments","commentContent","setCommentContent","classes","comment","reply"],"mappings":"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"}